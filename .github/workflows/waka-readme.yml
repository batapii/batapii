name: Metrics
on:
  repository_dispatch:
    types: [test_trigger]
  workflow_dispatch:
  schedule:
    - cron: '0 * * * *'
permissions:
  contents: write
  packages: read
  pull-requests: write
concurrency: 
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true
jobs:
  github-metrics:
    name: Update Readme with Metrics
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Debug Information
        run: |
          echo "Current directory: $(pwd)"
          echo "Repository contents:"
          ls -la
          echo "Python version:"
          python --version
          echo "Pip version:"
          pip --version
          echo "Searching for requirements.txt:"
          find . -name requirements.txt
          echo "Contents of requirements.txt (if found):"
          cat requirements.txt || echo "requirements.txt not found"
          echo "Contents of update_coding_stats.py (if found):"
          cat update_coding_stats.py || echo "update_coding_stats.py not found"

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          if [ -f "requirements.txt" ]; then
            echo "Installing from requirements.txt"
            pip install -r requirements.txt
          else
            echo "requirements.txt not found, installing requests manually"
            pip install requests
          fi
          echo "Installed packages:"
          pip list

      # ... (残りのステップは変更なし)
